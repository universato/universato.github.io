<!DOCTYPE html>
<html>
<head>
  <title>カレンダー日付選択</title>
  <link rel="stylesheet" type="text/css" href="schedule.css">
</head>
<body>
  <h1>カレンダー日付選択</h1>

  <div class="calendar" id="calendar">
    <div class="calendar-header">
      <button onclick="previousMonth()">&lt;</button>
      <span id="month-year"></span>
      <button onclick="nextMonth()">&gt;</button>
    </div>
    <div class="calendar-days" id="calendar-days"></div>
  </div>

  <label for="selectedDate">日付を選択してください:</label>
  <input type="text" id="selectedDate" readonly>

  <br>

  <label for="textArea">テキストエリア:</label>
  <br>
  <textarea id="textArea" rows="4" cols="50"></textarea>

  <script>
    var currentDate = new Date();
    var selectedDate = null;

    function generateCalendar() {
      var calendarDays = document.getElementById("calendar-days");
      calendarDays.innerHTML = "";

      var monthYear = document.getElementById("month-year");
      monthYear.innerText = formatDate(currentDate, "MMMM yyyy");

      var today = new Date();

      var firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
      var lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);

      // 曜日の表示
      var weekdays = ['日', '月', '火', '水', '木', '金', '土'];
      for (var i = 0; i < weekdays.length; i++) {
        var weekday = document.createElement("div");
        weekday.classList.add("calendar-day");
        weekday.innerText = weekdays[i];
        calendarDays.appendChild(weekday);
      }

      // Fill in empty days for the first week
      for (var i = 0; i < firstDay.getDay(); i++) {
        var emptyDay = document.createElement("div");
        emptyDay.classList.add("calendar-day");
        emptyDay.innerText = "";
        calendarDays.appendChild(emptyDay);
      }

      // Generate calendar days
      for (var day = 1; day <= lastDay.getDate(); day++) {
        var calendarDay = document.createElement("div");
        calendarDay.classList.add("calendar-day");
        calendarDay.innerText = day;

        var date = new Date(currentDate.getFullYear(), currentDate.getMonth(), day);

        if (selectedDate && isSameDate(currentDate, selectedDate) && day === selectedDate.getDate()) {
          calendarDay.classList.add("selected-day");
        }

        if (date.getDay() === 6) {
          calendarDay.classList.add("saturday");
        } else if (date.getDay() === 0) {
          calendarDay.classList.add("sunday");
        }

        if (isSameDate(date, today)) {
          calendarDay.classList.add("today");
        }

        calendarDay.addEventListener("click", function(e) {
          var day = e.target.innerText;
          selectedDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), day);

          var selectedDateInput = document.getElementById("selectedDate");
          selectedDateInput.value = formatDate(selectedDate, "YYYY年M月D日(ddd)");

          var textArea = document.getElementById("textArea");
          var selectedDateString = formatDate(selectedDate, "YYYY年M月D日(ddd)");
          textArea.value += selectedDateString + "\n";

          generateCalendar();
        });

        calendarDays.appendChild(calendarDay);
      }
    }

    function previousMonth() {
      currentDate.setMonth(currentDate.getMonth() - 1);
      generateCalendar();
    }

    function nextMonth() {
      currentDate.setMonth(currentDate.getMonth() + 1);
      generateCalendar();
    }

    function formatDate(date, format) {
      var options = {
        year: "numeric",
        month: "numeric",
        day: "numeric",
        weekday: "short"
      };

      return date.toLocaleDateString("ja-JP", options).replace(/(\d+)\/(\d+)\/(\d+)\((.)\)/, "$1年$2月$3日($4)");
    }

    function isSameDate(date1, date2) {
      return date1.getFullYear() === date2.getFullYear()
        && date1.getMonth() === date2.getMonth()
        && date1.getDate() === date2.getDate();
    }

    generateCalendar();
  </script>
</body>
</html>
